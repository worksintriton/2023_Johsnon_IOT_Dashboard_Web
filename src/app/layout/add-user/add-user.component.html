<div class="jumps-prevent" style="padding-top: 74px;">
</div>
<!-- /app-Header -->
<!--APP-SIDEBAR-->



<div class="jumps-prevent" style="padding-top: 74px;"></div>
<div class="main-content app-content mt-0">
    <div class="side-app">
        <!-- CONTAINER -->
        <div class="main-container container-fluid">
            <div class="page-header">
                <div>
                    <h2 *ngIf="addmode" class="main-content-title tx-24 mb-1">Add New User </h2>
                    <h2 *ngIf="editmode" class="main-content-title tx-24 mb-1">Edit New User </h2>
                    <!-- <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a routerLink="dashboard">Home</a></li>
                                <li class="breadcrumb-item active" aria-current="page"> Details</li>
                            </ol> -->
                </div>
                <div>
                    <button class="but" (click)="map()">Map</button>
                </div>

            </div>

        



            <div class="row row-sm aa">
                <!-- <div class="col-12 col-sm-12" style="    padding-bottom: 6px;">
                    <button class="but" (click)="map()">Map</button>
                </div> -->
                <div class="col-lg-12">
                    <div class="card custom-card">
                        <div class="card-body">
                            <div class="card-item">

                                <div class="row">
                                    <form [formGroup]="userForm" style="display: contents;">
                                        <div class="col-md-3">
                                            <h5 class="form-lable">Name:</h5>
                                            <input type="text" pInputText formControlName="name" placeholder="Enter Name" (keypress)="keyPressAlphanumeric($event)" 
                                             [ngClass]="{ 'is-invalid': submitted && f.name.errors }">
                                             <span *ngIf="submitted && f.name.errors" class="invalid-feedback">
                                                <span *ngIf="f.name.errors.required">Name is required</span>
                                             </span>
                                            <!-- <span class="text-danger"
                                            *ngIf=" (userForm.controls.name.touched) && userForm.controls.name.errors?.required ||submitted ">
                                            Name  is required
                                        </span> -->
                                        </div>
                                        <div class="col-md-3">
                                            <h5 class="form-lable">Employee No:</h5>
                                            <input type="text" pInputText formControlName="emp_no" placeholder="Enter Employee No" class="emp"
                                            [ngClass]="{ 'is-invalid': submitted && f.emp_no.errors }">
                                            <span *ngIf="submitted && f.emp_no.errors" class="invalid-feedback">
                                                <span *ngIf="f.emp_no.errors.required">Employee No is required</span>
                                             </span>
                                        </div>
                                        <div class="col-md-3">
                                            <h5 class="form-lable">Agent Code:</h5>
                                            <input type="text" pInputText formControlName="agent_code" placeholder="Enter Agent Code"
                                            [ngClass]="{ 'is-invalid': submitted && f.agent_code.errors }">
                                            <span *ngIf="submitted && f.agent_code.errors" class="invalid-feedback">
                                                <span *ngIf="f.agent_code.errors.required">Agent Code is required</span>
                                             </span>
                                        </div>

                                        <div class="col-md-3">
                                            <h5 class="form-lable">Password:</h5>
                                            <input type="text" pInputText formControlName="password" placeholder="Enter Password"
                                            [ngClass]="{ 'is-invalid': submitted && f.password.errors }">
                                             <span *ngIf="submitted && f.password.errors" class="invalid-feedback">
                                                <span *ngIf="f.password.errors.required">Password is required</span>
                                             </span>
                                        </div>

                                        <div class="col-md-3">
                                            <h5 class="form-lable">Email:</h5>
                                            <input type="email" pInputText formControlName="email_id" placeholder="Enter Email">
                                        </div>
                                        <div class="col-md-3">
                                            <h5 class="form-lable">Phone No:</h5>
                                            <input type="number" maxlength="10" oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"
                                                pInputText formControlName="phone_number" placeholder="Enter Phone No">
                                        </div>
                                        <div class="col-md-3">
                                            <h5 class="form-lable"> Status:</h5>
                                            <!-- <input type="text"  formControlName="active_status" placeholder="Enter Status"> -->
                                            <select formControlName="active_status" class="form-control1" placeholder="select" id="select-category">
                                                <!-- <option value="" selected disabled>Status</option> -->
                                                <option value="1">Active</option>
                                                <option value="2">In active</option>
                                              </select>
                                        </div>
                                        <div class="col-md-12">
                                            <h5 class="form-lable">Branch Code:</h5>

                                            <div class="row">
                                                <div class="col-md-3" *ngFor="let item of location">
                                                    <input type="checkbox" [checked]="item.check"[value]="item.branch_code" (change)="onCheckboxChange($event)" 
                                                    >
                                                    
                                                    <label for="veg1">{{item.branch_code}} &nbsp; {{item.branch_name}}</label> &nbsp;
                                                
                                                    </div>
                                                    <span *ngIf="checkstatus" class="invalid-feedback1">
                                                            <span>Branch Code is required</span>
                                                         </span>
                                            </div>

                                          

                                        </div>
                                    </form>
                                    <div class="col-md-3">
                                        <button *ngIf="addmode" type="button" class="btn btn-primary mt-4" (click)="addUser()">
                                            <!-- <i class="fas fa-plus-circle"></i>  -->
                                            Add</button>
                                        <button *ngIf="editmode" type="button" class="btn btn-primary mt-4" (click)="Edit_user()"> Update</button>
                                        <button *ngIf="editmode" type="button" class="btn btn-danger mt-4" (click)="cancel()">
                                            Cancel</button>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>


            <div class="row row-sm">

                <div class="col-lg-12">
                    <!--  <div class="card custom-card"> -->
                    <!-- <div class="card-body"> -->
                    <!-- <div class="card-item"> -->
                    <!-- <div class="col-12 col-sm-12"> -->
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title mb-0">USER LIST</h3>
                        </div>
                        <div class="card-body pt-4">
                            <div class="grid-margin">
                                <div class="">
                                    <div class="panel panel-primary">
                                        <div class="tab-menu-heading border-0 p-0">
                                            <div class="tabs-menu1">
                                                <!-- Tabs -->
                                                <ul class="nav panel-tabs product-sale">
                                                    <!--<li><a href="#tab5" class="active"
                                                                                        data-bs-toggle="tab">Hrs.</a></li>
                                                                               <li><a href="#tab6" data-bs-toggle="tab"
                                                                                        class="text-dark">Shipped</a></li>
                                                                                <li><a href="#tab7" data-bs-toggle="tab"
                                                                                        class="text-dark">Pending</a></li>
                                                                                <li><a href="#tab8" data-bs-toggle="tab"
                                                                                        class="text-dark">Cancelled</a></li> -->
                                                </ul>
                                            </div>
                                        </div>
                                        <div class=" tabs-menu-body border-0 pt-0">
                                            <div class="tab-content">
                                                <div class="tab-pane active" id="tab5">
                                                    <div class="table-responsive">
                                                        <div id="data-table_wrapper" class="dataTables_wrapper dt-bootstrap5 no-footer">
                                                            <div class="row">
                                                                <div class="col-sm-12 col-md-6">
                                                                    <div class="dataTables_length" id="data-table_length">
                                                                        <!-- <label>Show
                                                                            <select #myselect name="data-table_length" aria-controls="data-table" class="form-select form-select-sm select2 " tabindex="-1"
                                                                                aria-hidden="true" (change)="selected(myselect.value)">
                                                                                <option value="5">5
                                                                                </option>
                                                                                <option value="10">10
                                                                                </option>
                                                                                <option value="25">25
                                                                                </option>
                                                                                <option value="50">50
                                                                                </option>
                                                                                <option value="100">100
                                                                                </option>
                                                                            </select> -->
                                                                            <!-- <span
                                                                                                            class="select2 select2-container select2-container--default"
                                                                                                            dir="ltr" style="width: 61px;"><span
                                                                                                                class="selection"><span
                                                                                                                    class="select2-selection select2-selection--single"
                                                                                                                    role="combobox"
                                                                                                                    aria-haspopup="true"
                                                                                                                    aria-expanded="false"
                                                                                                                    tabindex="0"
                                                                                                                    aria-labelledby="select2-data-table_length-m4-container"><span
                                                                                                                        class="select2-selection__rendered"
                                                                                                                        id="select2-data-table_length-m4-container"
                                                                                                                        title="10">10</span><span
                                                                                                                        class="select2-selection__arrow"
                                                                                                                        role="presentation"><b
                                                                                                                            role="presentation"></b></span></span></span><span
                                                                                                                class="dropdown-wrapper"
                                                                                                                aria-hidden="true"></span></span> -->
                                                                            <!-- entries</label> -->
                                                                    </div>
                                                                </div>
                                                                <div class="col-sm-12 col-md-6">
                                                                    <div id="data-table_filter" class="dataTables_filter">
                                                                        <label>
                                                                            <input type="search" class="form-control form-control"
                                                                                placeholder="Search..." aria-controls="data-table" (input)="tt.filterGlobal($event.target.value, 'contains')"
                                                                                [(ngModel)]="term">
                                                                        </label>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-sm-12" #TABLE>
                                                                    <!-- <table id="data-table" class="table table-bordered text-nowrap mb-0 dataTable no-footer" role="grid" aria-describedby="data-table_info">
                                                                        <thead class="border-top">
                                                                            <tr role="row">
                                                                                <th class="bg-transparent border-bottom-0 " style="width: 88.7188px;" rowspan="1" colspan="1">
                                                                                    Name</th>

                                                                                <th class="bg-transparent border-bottom-0 " style="width: 88.7188px;" rowspan="1" colspan="1">
                                                                                    Employee No</th>
                                                                                <th class="bg-transparent border-bottom-0 " tabindex="0" rowspan="1" colspan="1" style="width: 119.906px;">
                                                                                    Agent Code</th>
                                                                                <th class="bg-transparent border-bottom-0 " tabindex="0" rowspan="1" colspan="1" style="width: 89.375px;">
                                                                                    Email</th>
                                                                                <th class="bg-transparent border-bottom-0 " tabindex="0" rowspan="1" colspan="1" style="width: 63.2031px;">
                                                                                    Phone No</th>

                                                                                <th class="bg-transparent border-bottom-0 " tabindex="0" rowspan="1" colspan="1" style="width: 63.2031px;">
                                                                                    Branch Code</th>
                                                                                <th class="bg-transparent border-bottom-0 " tabindex="0" rowspan="1" colspan="1" style="width: 63.2031px;">
                                                                                    Action</th>
                                                                                <!-- <th class="bg-transparent border-bottom-0 "
                                                                                                                rowspan="1" colspan="1"
                                                                                                                style="width: 75.3125px;">
                                                                                                                Cleared.Dt</th> 
                                                                                <!-- <th class="bg-transparent border-bottom-0 "
                                                                                                                rowspan="1" colspan="1"
                                                                                                                style="width: 106.797px;">
                                                                                                                Fault Desc</th> 

                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr class="border-bottom odd" *ngFor="let item of userList  | paginate: config| filter:term | slice:startIndex:endIndex ">
                                                                                <td class="text-center">
                                                                                    <div class="mt-0 mt-sm-2 d-block">
                                                                                        <h6 class="mb-0 fs-14 fw-semibold">{{item.name}}
                                                                                        </h6>
                                                                                    </div>
                                                                                </td>
                                                                                <td class="text-center">
                                                                                    <div class="mt-0 mt-sm-2 d-block">
                                                                                        <h6 class="mb-0 fs-14 fw-semibold">{{item.emp_no}}
                                                                                        </h6>
                                                                                    </div>
                                                                                </td>
                                                                                <td class="text-center">
                                                                                    <div class="d-flex">
                                                                                        <span class="avatar bradius"></span>
                                                                                        <div class="ms-3 mt-0 mt-sm-2 d-block">
                                                                                            <h6 class="mb-0 fs-14 fw-semibold">{{item.agent_code}}

                                                                                            </h6>
                                                                                        </div>
                                                                                    </div>
                                                                                </td>
                                                                                <td class="text-center">
                                                                                    <div class="d-flex">
                                                                                        <div class="mt-0 mt-sm-2 d-block">
                                                                                            <h6 class="mb-0 fs-14 fw-semibold">{{item.email_id}}
                                                                                            </h6>
                                                                                        </div>
                                                                                    </div>
                                                                                </td>
                                                                                <td class="text-center">
                                                                                    <div class="d-flex">
                                                                                        <div class="mt-0 mt-sm-2 d-block">
                                                                                            <h6>
                                                                                                {{item.phone_number}}
                                                                                            </h6>
                                                                                        </div>
                                                                                    </div>
                                                                                </td>

                                                                                <td class="text-center">
                                                                                    <div class="d-flex">
                                                                                        <span class="avatar bradius"></span>
                                                                                        <div class="ms-3 mt-0 mt-sm-2 d-block">
                                                                                            <h6 class="mb-0 fs-14 fw-semibold">{{item.branch_code}}

                                                                                            </h6>
                                                                                        </div>
                                                                                    </div>
                                                                                </td>
                                                                                <td class="text-center">
                                                                                    <div class="d-flex justify-content-center
                                                                                    ">
                                                                                        <div class="mt-0 mt-sm-2 d-block">

                                                                                            <i style="color: #223f9a;" class="fe fe-edit" aria-hidden="true"  data-bs-toggle="modal" data-bs-target="#staticBackdrop1" (click)="edit(item)" pTooltip="Edit"></i>
                                                                                            <i style="color: #fd2c3a;" class="fe fe-trash" aria-hidden="true"  data-bs-toggle="modal" data-bs-target="#staticBackdrop1" (click)="deleteUser(item._id)" pTooltip="Delete"></i>

                                                                                        </div>
                                                                                    </div>
                                                                                </td>


                                                                            </tr>

                                                                        </tbody>
                                                                    </table> -->
                                                                    <p-table #table #tt [value]="userList" styleClass="ui-table-customers"  [paginator]="true" [rows]="5"
  [rowHover]="true" [rowsPerPageOptions]="[5,10,25,50]" [showCurrentPageReport]="true"
  currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries" [globalFilterFields]="['name']">
  <ng-template pTemplate="caption">
    <div class="p-d-flex">
    
      <button type="button" pButton pRipple  (click)="exportExcel()" class="p-button-success p-mr-2 faicon" style="    background: #223f9a;
      border: 0 solid;padding: 5px 10px;" pTooltip="XLS" tooltipPosition="bottom"> <i style="color: white;" class="fa fa-file-excel-o"></i></button>
    
    </div>
  </ng-template>

  <ng-template pTemplate="header">
      <tr class="thhead">
          <th class="th-1">
            Name
          </th>
          <th>
            Employee No
          </th>
          <th>
            Agent Code
          </th>
          <th>Branch Code</th>
          <th>Email</th>
          <!-- <th>Modified by</th> -->
          <th>Phone Number</th>
          <th>Status</th>
          <!-- <th>Modified at</th> -->
          <th  style="width: 163px;text-align:center">
              Action
          </th>
      </tr>
  </ng-template>
  <ng-template pTemplate="body" let-item  let-i="rowIndex">
  <!-- <ng-container *ngFor="let item of user_type_list ; let i = index;"> -->
    <tr class="tdrow">
         

          <td>{{item.name}}</td>
          <td>
            {{item.emp_no}}
          </td>
          <td>
            {{item.agent_code}}
          </td>
          <td>{{item.branch_code}}</td>
          <td>
            {{item.email_id}}
          </td>
          <td>
            {{item.phone_number}}
          </td>
          <td>
              <span *ngIf="item.active_status=='1'">Active</span>
              <span *ngIf="item.active_status=='2'">InActive</span>
           
          </td>
          <td class="act text-center">
            <i style="color: #223f9a;" class="fe fe-edit" aria-hidden="true"  data-bs-toggle="modal" data-bs-target="#staticBackdrop1" (click)="edit(item)" pTooltip="Edit"></i>
            <i style="color: #fd2c3a;" class="fe fe-trash" aria-hidden="true"  data-bs-toggle="modal" data-bs-target="#staticBackdrop1" (click)="deleteUser(item._id)" pTooltip="Delete"></i>
              <!-- <i style="color: #4CAF50;" class="fa fa-info-circle" aria-hidden="true" pTooltip="View"></i> -->
          </td>
      </tr>
  <!-- </ng-container> -->
  </ng-template>
</p-table>


                                                                </div>
                                                            </div>
                                                            <!-- <div class="row">
                                                                <div class="col-sm-12 col-md-12">
                                                                    <div class="dataTables_info" id="data-table_info" role="status" aria-live="polite">Showing 1 to {{endIndex}} of {{total}} entries</div>
                                                                </div>
                                                                <div class="col-sm-12 col-md-12">
                                                                    <div class="dataTables_paginate paging_simple_numbers" id="data-table_paginate">
                                                                        <pagination-controls id="pagination1" (pageChange)="pageChanged($event)"></pagination-controls>
                                                                        <!-- <ul class="pagination">
                                                                                                        <li class="paginate_button page-item previous "
                                                                                                            id="data-table_previous"><a href="#"
                                                                                                                aria-controls="data-table"
                                                                                                                data-dt-idx="0" tabindex="0"
                                                                                                                class="page-link">Previous</a>
                                                                                                        </li>
                                                                                                        <li
                                                                                                            class="paginate_button page-item active">
                                                                                                            <a href="#" aria-controls="data-table"
                                                                                                                data-dt-idx="1" tabindex="0"
                                                                                                                class="page-link">1</a>
                                                                                                        </li>
                                                                                                        <li class="paginate_button page-item next "
                                                                                                            id="data-table_next"><a href="#"
                                                                                                                aria-controls="data-table"
                                                                                                                data-dt-idx="2" tabindex="0"
                                                                                                                class="page-link">Next</a>
                                                                                                        </li>
                                                                                                    </ul> 
                                                                    </div>
                                                                </div>
                                                            </div> -->
                                                        </div>
                                                    </div>
                                                </div>
                                            
                                               
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- </div> -->
                    <!-- </div>
                                </div> -->
                    <!-- </div> -->
                </div>
            </div>

        </div>
    </div>
</div>
<div class="modal fade" id="staticBackdrop1" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 *ngIf="editUser" class="modal-title" id="staticBackdropLabel">Are you sure want to Edit?</h5>
          <h5 *ngIf="delUser" class="modal-title" id="staticBackdropLabel">Are you sure want to Delete?</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" style=" margin: -1rem 0rem 0rem auto !important;"><span class="sa">X</span></button>
        </div>
      
        <div class="modal-footer">
            <button type="button" *ngIf="editUser" class="btn btn-primary" (click)="view()" >Yes</button>
            <button type="button" *ngIf="delUser" class="btn btn-primary" (click)="deluserdata()" >Yes</button>
          <button type="button" style=" background: #223f9a !important; " class="btn btn-secondary" data-bs-dismiss="modal" (click)="no()" #closeBtn>No</button>
          
        </div>
      </div>
    </div>
  </div>